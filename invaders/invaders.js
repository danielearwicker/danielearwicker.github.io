var sprites=new SpritePane(document.getElementById("tree")),lx=300,ly=300,bullets=new Array,maxBullets=2,currentAlien=0,direction=1,reverse=!1,reversing=!1,alienImages=new Array;alienImages.push("alien1.gif"),alienImages.push("alien2.gif");for(var aliens=new Array,n=0;n<maxBullets;n++){var b=sprites.create("bullet.gif",0,0,8,16,(function(){if(this.visible()){this.y-=20,this.y<0&&this.hide();for(var e=0;e<aliens.length;e++){var i=aliens[e];this.overlaps(i)&&(explosion.counter=10,explosion.x=i.x,explosion.y=i.y,explosion.show(),this.hide(),sprites.destroy(i),currentAlien>=e&&currentAlien--,aliens.splice(e,1))}}else spriteKeyDown(77)&&(spriteSetKey(77,!1),this.x=ship.x+8,this.y=ship.y-20,this.show())}));b.hide(),bullets.push(b)}var createAliens=function(){currentAlien=0,direction=1,reverse=!1,reversing=!1;for(var e=0;e<8;e++)for(var i=0;i<5;i++){var s=sprites.create(alienImages[0],24*(e+1),28*i+20,16,16,null);aliens.push(s),s.imageIndex=0,s.lastDirectionCounter=0,s.hide(),s.alienNinjaMoves=function(){if(this.visible())if(reversing){if(this.y+=12,this.y>ly-40)return void clearAliens()}else this.x+=6*direction,(1==direction&&this.x>=lx-32||-1==direction&&this.x<24)&&(reverse=!0);else this.show();this.changeImage(alienImages[this.imageIndex++]),this.imageIndex==alienImages.length&&(this.imageIndex=0)}}},clearAliens=function(){for(var e=0;e<aliens.length;e++)sprites.destroy(aliens[e]);aliens.splice(0,aliens.length)};sprites.updating.push((function(){if(currentAlien>=aliens.length&&(currentAlien=0,reverse?(reverse=!1,reversing=!0,direction=-direction):reversing&&(reversing=!1)),0==aliens.length)createAliens();else{var e=aliens[currentAlien++];e.alienNinjaMoves(),e.updatePosition()}}));var ship=sprites.create("ship.gif",lx/2,ly-30,24,16,(function(){spriteKeyDown(90)&&this.x>20?this.x-=10:spriteKeyDown(88)&&this.x<lx-32&&(this.x+=10)})),explosion=sprites.create("explosion.gif",0,0,16,16,(function(){this.counter&&this.counter>0&&(this.counter--,0==this.counter&&this.hide())}));explosion.hide(),sprites.go(30);